# ClawFeed v1.0 → v2.0 大版本规划

> 等效人类研发团队一年工作量。AI agent 团队预估实际周期短得多。

## 当前状态

| 指标 | 值 |
|------|-----|
| 版本 | v0.8.1 (production) |
| 用户 | 393（2/23 单日 +277 爆发增长） |
| 代码 | ~3,100 行（server 1,326 + SPA 1,768） |
| 架构 | Node.js + SQLite + Vanilla JS SPA |
| 依赖 | 仅 better-sqlite3（零外部服务） |
| Source 类型 | 10 种（Twitter/RSS/HN/Reddit/GitHub 等） |
| 输出 | RSS/JSON Feed/HTML |

## 核心理念

**"AI 编辑部"** — Source 越多 → 筛选池越大 → 输出质量越高 → 篇幅不变。
用户不看原始内容，只看 AI 精选的 15-20 条/期。

---

## Phase 1: 数据基础 + 个性化 (v0.9 → v1.0)

> 目标：从"Kevin 的个人工具"变成"每个用户有自己的 AI 编辑部"

### 1.1 raw_items 采集管道 ✅ PR #15 待 merge
- Source 级采集与 Digest 生成解耦
- raw_items 表 + 去重 + 并发池
- SSRF 防护 + 错误隔离
- 自动暂停连续失败的 Source

### 1.2 个性化 Digest 生成
- Digest 按用户订阅组合筛选 raw_items
- 注册自动订阅站长"默认推荐包"
- Digest 关联 user_id，前端按用户展示
- 空状态引导（推荐包 → 自定义）

### 1.3 Cron 采集集成
- 动态读取 `/api/sources?active=true`
- 按 Source 类型差异化采集频率（Twitter 30min / RSS 4h）
- 替代硬编码 Twitter 采集

### 1.4 Sources 页面重构
- 分区：已订阅 / 我创建的
- 订阅/退订操作
- Source 探索入口

**交付标准：** 用户注册后有独立的个性化 Digest，不再只看 Kevin 的内容。

---

## Phase 2: 分发 + 互动 (v1.0 → v1.5)

> 目标：用户不用主动打开网页也能收到内容，并能与内容互动

### 2.1 多渠道推送
| 渠道 | 优先级 | 说明 |
|------|--------|------|
| **Telegram Bot** | P0 | 定时推送 + `/digest` 按需查询 |
| **Email** | P1 | Daily/Weekly 邮件摘要，HTML 模板 |
| **Lark/Feishu** | P1 | 群机器人 + DM 推送 |
| **Slack** | P2 | Webhook 集成 |
| **Discord** | P2 | Channel 推送 |

用户侧配置：选择渠道 + 推送频率（每期 / 每日汇总 / 仅周报）

### 2.2 AI 互动助理 (Chat Widget)
- 右下角气泡式 Chat Box
- 基于当期 Digest 内容的问答
- "这条新闻的背景？" "帮我追踪这个话题"
- 深度分析：点击某条 → AI 展开详细解读
- 技术：ClawMark server 或独立 LLM 端点

### 2.3 Mark（收藏）增强
- 收藏时 AI 生成深度分析（已有基础）
- 收藏导出（Notion / Obsidian / Markdown）
- 收藏分享（公开链接）
- 基于收藏偏好的个性化推荐调优

### 2.4 Digest 质量提升
- Source 权重系统：高质量源提高权重
- 用户反馈循环：标记"有用/没用"训练偏好模型
- 话题追踪：连续关注某话题时自动加权
- 去重改进：跨 Source 内容去重（同一事件多个源报道）

**交付标准：** 用户通过 Telegram 接收个性化 Digest，能即时追问。

---

## Phase 3: 平台化 + Agent Friendly (v1.5 → v2.0)

> 目标：从 App 变成平台——外部 Agent 和开发者可以接入

### 3.1 Agent Friendly API
- 结构化 JSON Schema 输出
- MCP Server 支持（Claude/GPT agent 直接操作）
- Webhook 回调：Source 更新、Digest 生成完成事件
- 幂等操作设计（agent 重试安全）
- API 文档自动生成（OpenAPI spec）

### 3.2 Source Market
- 社区 Source 发现页
- 热门 Pack 推荐 + 分类浏览
- Source 评分 + 订阅数排行
- 一键安装 Pack
- Source 作者页面（贡献统计）

### 3.3 多语言 Digest
- 同一 Source Pool → 多语言版本输出
- 用户选择 Digest 语言（中/英/日 等）
- 翻译 + 本地化（不只是翻译，要做信息再组织）

### 3.4 订阅组合缓存
- `subscription_hash = SHA256(sorted(source_ids))`
- 相同组合共享 Digest 结果
- 预计覆盖率 > 80%（用户订阅高度重叠）
- LLM 调用成本降低 5-10x

### 3.5 分析仪表板
- 用户使用数据：阅读率、收藏率、推送打开率
- Source 贡献度：各 Source 被精选的比例
- 系统监控：采集成功率、LLM 调用量、延迟
- 管理后台：用户管理、Source 审核

**交付标准：** 第三方 AI Agent 可通过 API/MCP 操作 ClawFeed，开发者可基于 ClawFeed 构建产品。

---

## Phase 4: 商业化 + 规模化 (v2.0+)

> 目标：可持续的商业模式

### 4.1 付费层级
| 层级 | Source 上限 | Digest 频率 | 推送渠道 | 价格 |
|------|------------|------------|---------|------|
| Free | 10 Sources | Daily | RSS/Web | $0 |
| Pro | 50 Sources | 4H + Daily + Weekly | 全渠道 | $5/月 |
| Team | 200 Sources | 按需 | 全渠道 + API | $15/月 |
| Enterprise | 无限 | 按需 + 自定义 | 全渠道 + 私有部署 | 定制 |

### 4.2 团队/企业功能
- 共享 Source Pool + 团队 Digest
- 角色权限（管理员 / 编辑 / 读者）
- 团队级分析报告
- SSO / SAML 集成
- 自定义品牌

### 4.3 架构演进
| 领域 | 当前 | 目标 |
|------|------|------|
| 数据库 | SQLite 单文件 | SQLite (小规模) / PostgreSQL (大规模) |
| 前端 | Vanilla JS SPA | 渐进式升级（Preact/Svelte 可选） |
| 部署 | 单机 PM2 | Docker + Fly.io / Railway |
| 采集 | 单进程 | Worker pool + 消息队列 |
| 缓存 | 无 | Redis / in-memory 订阅组合缓存 |

### 4.4 高级 Source 类型
- Newsletter 邮件解析（收件箱 → Source）
- YouTube/Podcast 转文字
- 论文（arXiv / Semantic Scholar）
- 微信公众号
- 企业内部 Wiki / Confluence

---

## 里程碑时间线

```
v0.9  ─── raw_items + cron 集成 ─── 采集管道上线
  │
v1.0  ─── 个性化 Digest + Sources 重构 ─── 真正的多用户产品
  │
v1.2  ─── Telegram 推送 + Email ─── 主动分发
  │
v1.5  ─── AI Chat + Mark 增强 + 质量优化 ─── 互动体验
  │
v1.8  ─── MCP + Source Market + 多语言 ─── 平台化
  │
v2.0  ─── 付费 + 团队 + 分析 ─── 商业化
```

## 技术债清理（贯穿全程）

- [ ] 前端组件化（当前 1,768 行单文件 SPA）
- [ ] API 层抽出 Express/Fastify（当前原生 HTTP）
- [ ] 测试覆盖率提升（当前 66 assertions → 200+）
- [ ] CI/CD 自动部署（当前手动）
- [ ] 日志 + 监控（结构化日志 + 错误追踪）
- [ ] API 版本控制（v1/ 前缀）

## 关键指标

| 阶段 | 目标用户 | 目标 DAU | 关键指标 |
|------|---------|---------|---------|
| v1.0 | 1K | 200 | 注册转化率 > 30% |
| v1.5 | 5K | 1K | 推送打开率 > 40% |
| v2.0 | 20K | 5K | 付费转化率 > 5% |
| v2.0+ | 100K | 20K | MRR $10K+ |

---

*Generated by Jessie — 2026-02-25*
